<template>
    <div class="">
        <div if:true={isSpinner} class="spinner-container">
            <div class="loader"></div>
            <div class="wait-text">Please wait...</div>
        </div>
        <!-- Start first page -->
        <template if:true={showFirstPage}>
            <div class="mains">
                <div class="main">
                    <h1 class="head"><i> Site Visit Form </i></h1>
                </div>
            </div>
            <div class="mains">
                <div class="main">
                    <form class="slds-p-around_medium" style="position: relative;">
                        <lightning-layout multiple-rows>
                            <lightning-layout-item size="6" class="slds-p-around_xx-small">
                                <lightning-combobox label="Select Project" name="Select Project"
                                    class="slds-p-bottom_small slds-p-top_small" required variant="standard"
                                    options={projectOptions} value={projectId} onchange={handleProjectChange}
                                    disabled={disabledProject}>
                                </lightning-combobox>
                            </lightning-layout-item>
                            <lightning-layout-item size="6" class="slds-p-around_xx-small">
                                <lightning-combobox label="Pre-registration Available ?"
                                    name="Pre-registration Available ?" class="slds-p-bottom_small slds-p-top_small"
                                    required variant="standard" value={registration} placeholder="Please Select"
                                    options={options} onchange={handleRegistration} disabled={disableReg}>
                                </lightning-combobox>
                            </lightning-layout-item>
                            <lightning-layout-item size="6" class="slds-p-around_xx-small" if:true={showCode}>
                                <lightning-input type="text" label="Pre-registration code" name="Pre-registration code"
                                    placeholder="Enter Code" required variant="standard" value={regCode}
                                    disabled={disabledregcode} onchange={handleRegCode}></lightning-input>
                            </lightning-layout-item>
                            <lightning-layout-item size="6" class="slds-p-around_xx-small" if:true={showNumber}>
                                <lightning-input type="tel" label="Mobile" placeholder="e.g.1234567890" maxlength="10"
                                    pattern="[0-9]{10}$" required variant="standard" value={storeMobile}
                                    message-when-pattern-mismatch="Please Enter Valid Mobile Number"
                                    disabled={disabledMobile} field-name="Mobile__c" name="Mobile__c"
                                    onchange={handlemobile}></lightning-input>
                            </lightning-layout-item>
                        </lightning-layout>
                    </form>

                    <div class="slds-docked-form-footer">
                        <button class="slds-button slds-button_icon slds-button_icon slds-button_icon-error"
                            title="Resolve error" if:true={showValidationPopup}>
                            <lightning-icon icon-name="utility:error" alternative-text="Error" size="xx-small"
                                title="large size" variant="brand" aria-hidden="true"></lightning-icon>
                            <span class="slds-assistive-text">Mandatory Details</span>
                        </button>

                        <!-- footer buttons -->
                        <lightning-button type="button" label="Reset" class="slds-p-around_xx-small"
                            variant="destructive-text" title="Reset" onclick={handleReset}>Reset</lightning-button>

                        <template if:false={hideSearch}>
                            <template if:false={isQrcustomer}>
                            <lightning-layout multiple-rows>
                                <lightning-layout-item size="12" class="slds-p-around_xx-small">
                                    <lightning-button variant="brand" label="Search" title="Search" type="button"
                                        class="slds-align_absolute-center" onclick={handleSearch}></lightning-button>
                                </lightning-layout-item>
                            </lightning-layout>
                            </template>
                            <template if:true={isQrcustomer}>
                                <lightning-layout multiple-rows>
                                    <lightning-layout-item size="12" class="slds-p-around_xx-small">
                                        <lightning-button variant="brand" label="Next" title="Next" type="button"
                                            class="slds-align_absolute-center" onclick={handleSearch}></lightning-button>
                                    </lightning-layout-item>
                                </lightning-layout>
                                </template>
                        </template><br/>


                        <!-- footer buttons -->
                        <section if:true={showValidationPopup} aria-describedby="dialog-body-id-4"
                            aria-labelledby="dialog-heading-id-2"
                            class="slds-popover slds-popover_error slds-nubbin_bottom-left" role="dialog"
                            style="position:absolute;bottom:56px;left:50%;margin-left:62px;transform:translateX(-50%)">
                            <button
                                class="slds-button slds-button_icon slds-button_icon-small slds-float_right slds-popover__close slds-button_icon-inverse"
                                title="Close dialog">
                                <lightning-icon icon-name="utility:close" alternative-text="CLose" size="xx-small"
                                    title="large size" variant="inverse" class="slds-icon slds-icon_x-small"
                                    aria-hidden="true" onclick={handleclosepopup}></lightning-icon>
                                <span class="slds-assistive-text">Close dialog</span>
                            </button>
                            <header class="slds-popover__header">
                                <div class="slds-media slds-media_center slds-has-flexi-truncate ">
                                    <div class="slds-media__figure">
                                        <span class="slds-icon_container slds-icon-utility-error">
                                            <lightning-icon icon-name="utility:error" alternative-text="Error"
                                                size="xx-small" title="large size" variant="inverse"
                                                class="slds-icon slds-icon_x-small" aria-hidden="true"></lightning-icon>

                                        </span>
                                    </div>
                                    <div class="slds-media__body" if:true={showValidationPopup}>
                                        <h2 class="slds-truncate slds-text-heading_medium" id="dialog-heading-id-2"
                                            title="Resolve error">Mandatory Fields</h2>
                                    </div>
                                </div>
                            </header>

                            <div class="slds-popover__body" id="dialog-body-id-4">
                                <p if:true={showValidationPopup}> {showValidation}
                                    <!-- <a href="#" title="Learn More">Learn More</a> -->
                                </p>
                            </div>
                        </section>
                    </div>

                    <template if:true={showVerify}>
                        <div class="slds-docked-form-footer">
                            <button class="slds-button slds-button_icon slds-button_icon slds-button_icon-error"
                                title="Resolve error" if:true={showValidationPopup}>
                                <lightning-icon icon-name="utility:error" alternative-text="Error" size="xx-small"
                                    title="large size" variant="brand" aria-hidden="true"></lightning-icon>
                                <span class="slds-assistive-text">Mandatory Details</span>
                            </button>
                            <template if:true={showVerify}>
                                <lightning-layout multiple-rows>
                                    <lightning-layout-item size="12" class="slds-p-around_xx-small">
                                        <lightning-button variant="brand" label="Verify Code" title="Verify Code"
                                            type="button" class="slds-align_absolute-center"
                                            onclick={handleVerifyCode}></lightning-button>
                                    </lightning-layout-item>
                                </lightning-layout>
                            </template>
                            <!-- <button type="button" class="slds-button slds-button_destructive" title="Reset"
                                onclick={handleReset}>Reset</button> -->
                            <lightning-button type="button" label="Reset" class="slds-p-around_xx-small"
                                variant="destructive-text" title="Reset" onclick={handleReset}>Reset</lightning-button>
                            <section if:true={showValidationPopup} aria-describedby="dialog-body-id-5"
                                aria-labelledby="dialog-heading-id-3"
                                class="slds-popover slds-popover_error slds-nubbin_bottom-left" role="dialog"
                                style="position:absolute;bottom:56px;left:50%;margin-left:62px;transform:translateX(-50%)">
                                <button
                                    class="slds-button slds-button_icon slds-button_icon-small slds-float_right slds-popover__close slds-button_icon-inverse"
                                    title="Close dialog">
                                    <lightning-icon icon-name="utility:close" alternative-text="CLose" size="xx-small"
                                        title="large size" variant="inverse" class="slds-icon slds-icon_x-small"
                                        aria-hidden="true" onclick={handleclosepopup}></lightning-icon>

                                    <span class="slds-assistive-text">Close dialog</span>
                                </button>
                                <header class="slds-popover__header">
                                    <div class="slds-media slds-media_center slds-has-flexi-truncate ">
                                        <div class="slds-media__figure">
                                            <span class="slds-icon_container slds-icon-utility-error">
                                                <lightning-icon icon-name="utility:error" alternative-text="Error"
                                                    size="xx-small" title="large size" variant="inverse"
                                                    class="slds-icon slds-icon_x-small"
                                                    aria-hidden="true"></lightning-icon>

                                            </span>
                                        </div>
                                        <div class="slds-media__body" if:true={showValidationPopup}>
                                            <h2 class="slds-truncate slds-text-heading_medium" id="dialog-heading-id-3"
                                                title="Resolve error">Mandatory Fields</h2>
                                        </div>
                                    </div>
                                </header>
                                <div class="slds-popover__body" id="dialog-body-id-5">
                                    <p if:true={showValidationPopup}> {showValidation}
                                        <!-- <a href="#" title="Learn More">Learn More</a> -->
                                    </p>
                                </div>
                            </section>
                        </div>
                    </template>
                </div>


                <template if:true={showVprData}>
                    <template if:false={isQrcustomer}>
                    <table style="border: 2px solid black;border-collapse: collapse;">
                        <thead>
                            <tr>
                                <th class="slds-box" style="border: 1px solid black;">Customer Name</th>
                                <th class="slds-box" style="border: 1px solid black;">Project Name</th>
                                <th class="slds-box" style="border: 1px solid black;">Budget Range</th>
                                <th class="slds-box" style="border: 1px solid black;">Configuration Required</th>
                            </tr>

                            <!-- <template for:each={showVprDataArray} for:item="cp"> -->
                            <tr style="color: black;">
                                <td class="slds-box" style="border: 1px solid black;">
                                    {showVprDataArray.Customer_Name__c}
                                </td>
                                <td class="slds-box" style="border: 1px solid black;"
                                    if:true={showVprDataArray.Project__r.Name}>
                                    {showVprDataArray.Project__r.Name}</td>
                                <td class="slds-box" style="border: 1px solid black;">{showVprDataArray.Budget_Range__c}
                                </td>
                                <td class="slds-box" style="border: 1px solid black;">
                                    {showVprDataArray.Configuration__c}
                                </td>
                            </tr>
                            <!-- </template> -->
                        </thead>
                    </table><br /><br />
                    </template>
                </template>

                <div class="container">
                    <template if:false={isQrcustomer}>
                   
                    <template if:true={showAccountDataFound}>
                       
                        <div style="text-align: center; padding:20px !important;" class="box2">
                            <table class="slds-table slds-table_col-bordered slds-p-around_medium custom-table">
                                <thead>
                                    <tr>
                                        <th colspan="3" style="color: #0e3aed;text-align:center;font-size:16px;">
                                            Account Details
                                        </th>
                                    </tr>
                                    <tr>
                                        <th>Full Name</th>
                                        
                                    </tr>
                                </thead>
                                <tbody>

                                    <template for:each={accountDataFound} for:item="account" for:index="index">
                                        <tr key={account.Id}>
                                            <td>
                                               <template if:true={account.FirstName}>
                                                {account.FirstName} 
                                               </template>
                                                <template if:true={account.LastName}>
                                                {account.LastName}
                                                </template>
                                            </td>
                                            
                                        </tr>
                                    </template>
                                </tbody>
                            </table>
                        </div><br /><br />
                    </template>
                    </template>

                    <template if:false={isQrcustomer}>
                    <template if:true={showOpportunityDataFound} >
                       
                        <div style="text-align: center; padding:20px !important;" class="box2">
                            <table class="slds-table slds-table_col-bordered slds-p-around_medium custom-table">
                                <thead>
                                    <tr>
                                        <th colspan="4" style="color: #0e3aed;text-align:center;font-size:16px;">
                                            Opportunity Details</th>
                                    </tr>
                                    <tr>
                                        <th>Name</th>
                                        <th>Sales Manager</th>
                                        <th>Source</th>
                                        <th>Last Visit Date</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <template for:each={opportunityDataFound} for:item="opportunity" for:index="index">
                                        <tr key={opportunity.Id}>
                                            <td>{opportunity.Name}</td>
                                            <td>{opportunity.Sales_Manager__r.Name}</td>
                                            <td>{opportunity.Source__c}</td>
                                            <th>
                                                <lightning-formatted-date-time value={opportunity.Last_SV_Date__c} year="numeric" month="numeric" day="numeric" hour="2-digit"
                                                    minute="2-digit" time-zone-name="short"></lightning-formatted-date-time>
            </th>
                                            <!-- <td>{opportunity.Owner.Name}</td> -->
                                        </tr>
                                    </template>
                                </tbody>
                            </table>
                        </div><br /><br /><br />
                    </template>
                    </template>
                </div>

                <template if:false={isQrcustomer}>
                <template if:true={showLeadDataFound}>
                   
                    <div style="text-align: center; padding:20px !important;">
                        <table class="slds-table slds-table_col-bordered slds-p-around_medium custom-table">
                            <thead>
                                <tr>
                                    <th style="color: #0e3aed;text-align:center;font-size:16px;" colspan="5">Lead
                                        Details</th>
                                </tr>
                                <tr>
                                    <th>Full Name</th>
                                    <th>Presales Manager</th>
                                    <th>Source Details</th>
                                    <th>Last Presales Call Date</th>
                                    <th>Proposed Re-Visit Date</th>
                                </tr>
                            </thead>
                            <tbody>
                                <template if:true={leadDataFound.length}>
                                    <template for:each={leadDataFound} for:item="lead" for:index="index">
                                        <tr key={lead.Id}>
                                            <td>{lead.Full_Name__c}</td>
                                            <td>{lead.Owner.Name}</td>
                                            <td>{lead.Lead_Source__c}</td>
                                            <td> <lightning-formatted-date-time value={lead.Presales_Last_Call_Date__c} year="numeric" month="numeric" day="numeric" hour="2-digit"
                                                minute="2-digit" time-zone-name="short"></lightning-formatted-date-time>
                                                </td>
                                            <td> <lightning-formatted-date-time value={lead.Presales_Proposed_Visit_Date__c} year="numeric" month="numeric" day="numeric" hour="2-digit"
                                                minute="2-digit" time-zone-name="short"></lightning-formatted-date-time>
                                                </td>

                                            
                                        </tr>
                                    </template>
                                </template>
                            </tbody>
                        </table>
                    </div><br /><br /><br />
                </template>
                </template>




                <template if:false={isQrcustomer}>
                <template if:true={nodataFound}>
                    <p style="text-align: center;color:black; font-size: 18px;">No Data Available.
                    </p>
                </template>
                </template>

                <template if:true={createNewData}>
                    <div class="slds-docked-form-footer">
                        <button class="slds-button slds-button_icon slds-button_icon slds-button_icon-error"
                            title="Resolve error" if:true={showValidationPopup}>
                            <lightning-icon icon-name="utility:error" alternative-text="Error" size="xx-small"
                                title="large size" variant="brand" aria-hidden="true"></lightning-icon>
                            <span class="slds-assistive-text">Mandatory Details</span>
                        </button>

                        <lightning-layout multiple-rows>
                            <lightning-layout-item size="12" class="slds-p-around_xx-small">
                                <lightning-button variant="brand" title="Continue" onclick={handleContinue}
                                    type="button" class="slds-align_absolute-center"
                                    label="Continue"></lightning-button>
                            </lightning-layout-item>
                        </lightning-layout>

                       <lightning-button type="button" label="Reset" class="slds-p-around_xx-small"
                                variant="destructive-text" title="Reset" onclick={handleReset}>Reset</lightning-button>

                        <section if:true={showValidationPopup} aria-describedby="dialog-body-id-5"
                            aria-labelledby="dialog-heading-id-3"
                            class="slds-popover slds-popover_error slds-nubbin_bottom-left" role="dialog"
                            style="position:absolute;bottom:56px;left:50%;margin-left:62px;transform:translateX(-50%)">
                            <button
                                class="slds-button slds-button_icon slds-button_icon-small slds-float_right slds-popover__close slds-button_icon-inverse"
                                title="Close dialog">
                                <lightning-icon icon-name="utility:close" alternative-text="CLose" size="xx-small"
                                    title="large size" variant="inverse" class="slds-icon slds-icon_x-small"
                                    aria-hidden="true" onclick={handleclosepopup}></lightning-icon>

                                <span class="slds-assistive-text">Close dialog</span>
                            </button>
                            <header class="slds-popover__header">
                                <div class="slds-media slds-media_center slds-has-flexi-truncate ">
                                    <div class="slds-media__figure">
                                        <span class="slds-icon_container slds-icon-utility-error">
                                            <lightning-icon icon-name="utility:error" alternative-text="Error"
                                                size="xx-small" title="large size" variant="inverse"
                                                class="slds-icon slds-icon_x-small" aria-hidden="true"></lightning-icon>
                                        </span>
                                    </div>
                                    <div class="slds-media__body" if:true={showValidationPopup}>
                                        <h2 class="slds-truncate slds-text-heading_medium" id="dialog-heading-id-4"
                                            title="Resolve error">Mandatory Fields</h2>
                                    </div>
                                </div>
                            </header>
                            <div class="slds-popover__body" id="dialog-body-id-6">
                                <p if:true={showValidationPopup}> {showValidation}
                                    <!-- <a href="#" title="Learn More">Learn More</a> -->
                                </p>
                            </div>
                        </section>
                    </div>
                </template>
            </div>
        </template>
    </div>
    <!-- End first page -->



    <!-- Basic Details -->
    <template if:true={showSecondPage}>
        <div class="mains">
            <div class="main">
                <h1 class="head">Basic Details</h1>
            </div>
        </div>
        <div class="fixed-image">
            <lightning-formatted-rich-text value={showProjectImage}>
            </lightning-formatted-rich-text>
        </div>
        <lightning-record-edit-form density="compact" object-api-name="Site_Visit__c">
            <form class="slds-p-around_medium" style="height: 100%;">
                <lightning-layout multiple-rows>
                    <lightning-layout-item size="12" class="slds-p-around_xx-small">
                        <lightning-combobox label="Salutation" name="Salutation__c" field-name="Salutation__c"
                            options={Salutation} class="slds-p-bottom_small slds-p-top_small" variant="standard"
                            value={svWrapper.sv.Salutation__c} onchange={handleChange}></lightning-combobox>
                    </lightning-layout-item>
                    <lightning-layout-item size="6" class="slds-p-around_xx-small">
                        <lightning-input type="text" label="First Name" name="First_Name__c" field-name="First_Name__c"
                            placeholder="Enter First Name" value={svWrapper.sv.First_Name__c} required
                            variant="standard" onchange={handleChange}></lightning-input>
                    </lightning-layout-item>
                    <lightning-layout-item size="6" class="slds-p-around_xx-small">
                        <lightning-input type="text" label="Last Name" name="Last_Name__c" field-name="Last_Name__c"
                            placeholder="Enter Last Name" value={svWrapper.sv.Last_Name__c} required variant="standard"
                            onchange={handleChange}></lightning-input>
                    </lightning-layout-item>
                </lightning-layout>
                <lightning-layout multiple-rows>
                    <lightning-layout-item size="6" class="slds-p-around_xx-small">
                        <lightning-input-field field-name="Email__c" value={svWrapper.sv.Email__c} 
                        disabled="true"
                            onchange={handleChange} variant="standard"></lightning-input-field>
                    </lightning-layout-item>
                    <lightning-layout-item size="6" class="slds-p-around_xx-small" if:true={showNumber}>
                        <lightning-input type="tel" label="Mobile" placeholder="e.g.1234567890" maxlength="10"
                            pattern="[0-9]{10}$" variant="standard" value={storeMobile}
                            message-when-pattern-mismatch="Please Enter Valid Mobile Number" disabled={disabledMobile}
                            field-name="Mobile__c" name="Mobile__c"></lightning-input>
                    </lightning-layout-item>

                </lightning-layout>
                <lightning-layout multiple-rows>
                    <lightning-layout-item size="6" class="slds-p-around_xx-small">
                        <lightning-input-field field-name="Age_Group__c" value={svWrapper.sv.Age_Group__c} required
                            onchange={handleChange} variant="standard"></lightning-input-field>
                    </lightning-layout-item>
                    <lightning-layout-item size="6" class="slds-p-around_xx-small">
                        <lightning-input-field field-name="Nationality__c" value={svWrapper.sv.Nationality__c} required
                            onchange={handleChange} variant="standard"></lightning-input-field>
                    </lightning-layout-item>
                </lightning-layout><br /><br /><br />
            </form>
        </lightning-record-edit-form>
        <div class="slds-docked-form-footer">
            <button class="slds-button slds-button_icon slds-button_icon slds-button_icon-error" title="Resolve error"
                if:true={showValidationPopup}>
                <lightning-icon icon-name="utility:error" alternative-text="Error" size="xx-small" title="large size"
                    variant="brand" aria-hidden="true"></lightning-icon>
                <span class="slds-assistive-text">Mandatory Details</span>
            </button>


            <lightning-button variant="brand" title="Previous" onclick={handlesecondPagePrevious} type="button"
                label="Previous">
            </lightning-button> &nbsp; &nbsp;


            <lightning-button variant="brand" title="Next" onclick={handlesecondPageNext} type="button"
                label="Next"></lightning-button>


            <section if:true={showValidationPopup} aria-describedby="dialog-body-id-5"
                aria-labelledby="dialog-heading-id-3" class="slds-popover slds-popover_error slds-nubbin_bottom-left"
                role="dialog"
                style="position:absolute;bottom:56px;left:50%;margin-left:62px;transform:translateX(-50%)">
                <button
                    class="slds-button slds-button_icon slds-button_icon-small slds-float_right slds-popover__close slds-button_icon-inverse"
                    title="Close dialog">
                    <lightning-icon icon-name="utility:close" alternative-text="CLose" size="xx-small"
                        title="large size" variant="inverse" class="slds-icon slds-icon_x-small" aria-hidden="true"
                        onclick={handleclosepopup}></lightning-icon>

                    <span class="slds-assistive-text">Close dialog</span>
                </button>
                <header class="slds-popover__header">
                    <div class="slds-media slds-media_center slds-has-flexi-truncate ">
                        <div class="slds-media__figure">
                            <span class="slds-icon_container slds-icon-utility-error">
                                <lightning-icon icon-name="utility:error" alternative-text="Error" size="xx-small"
                                    title="large size" variant="inverse" class="slds-icon slds-icon_x-small"
                                    aria-hidden="true"></lightning-icon>
                            </span>
                        </div>
                        <div class="slds-media__body" if:true={showValidationPopup}>
                            <h2 class="slds-truncate slds-text-heading_medium" id="dialog-heading-id-5"
                                title="Resolve error">Mandatory Fields</h2>
                        </div>
                    </div>
                </header>
                <div class="slds-popover__body" id="dialog-body-id-7">
                    <p if:true={showValidationPopup}> {showValidation}
                        <!-- <a href="#" title="Learn More">Learn More</a> -->
                    </p>
                </div>
            </section>
        </div>
    </template>
    <!-- Basic Details -->



    <!-- Residential Address -->
    <template if:true={showthirdPage}>
        <div class="mains">
            <div class="main">
                <h1 class="head">Residential Address</h1>
            </div>
        </div>
        <div class="fixed-image">
            <lightning-formatted-rich-text value={showProjectImage}>
            </lightning-formatted-rich-text>
        </div>

        <lightning-record-edit-form density="compact" object-api-name="Site_Visit__c">
            <form class="slds-p-around_medium">
                <lightning-layout multiple-rows>
                    <lightning-layout-item size="6" class="slds-p-around_xx-small">
                        <lightning-input-field field-name="Residential_Address__c"
                            value={svWrapper.sv.Residential_Address__c} onchange={handleChange}
                            variant="standard"></lightning-input-field>
                    </lightning-layout-item>

                    <lightning-layout-item size="6" class="slds-p-around_xx-small">
                        <lightning-input-field field-name="Locality__c" value={svWrapper.sv.Locality__c} required
                            onchange={handleChange} variant="standard"></lightning-input-field>
                    </lightning-layout-item>
                </lightning-layout>

                <lightning-layout multiple-rows>
                    <lightning-layout-item size="6" class="slds-p-around_xx-small">
                        <lightning-input-field field-name="City__c" value={svWrapper.sv.City__c} required
                            onchange={handleChange} variant="standard"></lightning-input-field>
                    </lightning-layout-item>

                    <lightning-layout-item size="6" class="slds-p-around_xx-small">
                        <lightning-input-field field-name="State__c" value={svWrapper.sv.State__c} required
                            onchange={handleChange} variant="standard"></lightning-input-field>
                    </lightning-layout-item>
                </lightning-layout>

                <lightning-layout multiple-rows>

                    <lightning-layout-item size="6" class="slds-p-around_xx-small">
                        <lightning-input-field field-name="Pincode__c" value={svWrapper.sv.Pincode__c} required
                            onchange={handleChange} variant="standard"></lightning-input-field>
                    </lightning-layout-item>
                </lightning-layout><br /><br /><br />

            </form>
        </lightning-record-edit-form>
        <div class="slds-docked-form-footer">
            <button class="slds-button slds-button_icon slds-button_icon slds-button_icon-error" title="Resolve error"
                if:true={showValidationPopup}>
                <lightning-icon icon-name="utility:error" alternative-text="Error" size="xx-small" title="large size"
                    variant="brand" aria-hidden="true"></lightning-icon>
                <span class="slds-assistive-text">Mandatory Details</span>
            </button>


            <lightning-button variant="brand" title="Previous" onclick={handlethirdPagePrevious} type="button"
                label="Previous"></lightning-button> &nbsp; &nbsp;


            <lightning-button variant="brand" title="Next" onclick={handlethirdPageNext} type="button"
                label="Next"></lightning-button>

            <section if:true={showValidationPopup} aria-describedby="dialog-body-id-5"
                aria-labelledby="dialog-heading-id-3" class="slds-popover slds-popover_error slds-nubbin_bottom-left"
                role="dialog"
                style="position:absolute;bottom:56px;left:50%;margin-left:62px;transform:translateX(-50%)">
                <button
                    class="slds-button slds-button_icon slds-button_icon-small slds-float_right slds-popover__close slds-button_icon-inverse"
                    title="Close dialog">
                    <lightning-icon icon-name="utility:close" alternative-text="CLose" size="xx-small"
                        title="large size" variant="inverse" class="slds-icon slds-icon_x-small" aria-hidden="true"
                        onclick={handleclosepopup}></lightning-icon>

                    <span class="slds-assistive-text">Close dialog</span>
                </button>
                <header class="slds-popover__header">
                    <div class="slds-media slds-media_center slds-has-flexi-truncate ">
                        <div class="slds-media__figure">
                            <span class="slds-icon_container slds-icon-utility-error">
                                <lightning-icon icon-name="utility:error" alternative-text="Error" size="xx-small"
                                    title="large size" variant="inverse" class="slds-icon slds-icon_x-small"
                                    aria-hidden="true"></lightning-icon>
                            </span>
                        </div>
                        <div class="slds-media__body" if:true={showValidationPopup}>
                            <h2 class="slds-truncate slds-text-heading_medium" id="dialog-heading-id-6"
                                title="Resolve error">Mandatory Fields</h2>
                        </div>
                    </div>
                </header>
                <div class="slds-popover__body" id="dialog-body-id-8">
                    <p if:true={showValidationPopup}> {showValidation}
                        <!-- <a href="#" title="Learn More">Learn More</a> -->
                    </p>
                </div>
            </section>
        </div>
    </template>
    <!-- Residential Address -->



    <!-- Employment Details -->
    <template if:true={showFourthPage}>
        <div class="mains">
            <div class="main">
                <h1 class="head">Employment Details</h1>
            </div>
        </div>
        <div class="fixed-image">
            <lightning-formatted-rich-text value={showProjectImage}>
            </lightning-formatted-rich-text>
        </div>

        <lightning-record-edit-form density="compact" object-api-name="Site_Visit__c">
            <form class="slds-p-around_medium">
                <lightning-layout multiple-rows>
                    <lightning-layout-item size="6" class="slds-p-around_xx-small">
                        <lightning-input-field field-name="Employment_Type__c" value={svWrapper.sv.Employment_Type__c}
                            required onchange={handleChange} variant="standard"></lightning-input-field>
                    </lightning-layout-item>
                    <lightning-layout-item size="6" class="slds-p-around_xx-small">
                        <lightning-input-field field-name="Company_Name__c" value={svWrapper.sv.Company_Name__c}
                            onchange={handleChange} variant="standard"></lightning-input-field>
                    </lightning-layout-item>
                </lightning-layout>

                <lightning-layout multiple-rows>
                    <lightning-layout-item size="6" class="slds-p-around_xx-small">
                        <lightning-input-field field-name="Industry__c" value={svWrapper.sv.Industry__c} 
                            onchange={handleChange} variant="standard"></lightning-input-field>
                    </lightning-layout-item>
                    <lightning-layout-item size="6" class="slds-p-around_xx-small">
                        <lightning-input-field field-name="Designation__c" value={svWrapper.sv.Designation__c} 
                            onchange={handleChange} variant="standard"></lightning-input-field>
                    </lightning-layout-item>
                </lightning-layout>

                <lightning-layout multiple-rows>
                    <lightning-layout-item size="6" class="slds-p-around_xx-small">
                        <lightning-input-field field-name="Annual_Income__c" value={svWrapper.sv.Annual_Income__c}
                             onchange={handleChange} variant="standard"></lightning-input-field>
                    </lightning-layout-item>


                    <lightning-layout-item size="6" class="slds-p-around_xx-small">
                        <lightning-input-field field-name="Office_Pincode__c" value={svWrapper.sv.Office_Pincode__c} required
                            onchange={handleChange} variant="standard"></lightning-input-field>
                    </lightning-layout-item>
                </lightning-layout>

                <lightning-layout multiple-rows>
                    <lightning-layout-item size="6" class="slds-p-around_xx-small">
                        <lightning-input-field field-name="Office_Location__c" value={svWrapper.sv.Office_Location__c}
                            onchange={handleChange} variant="standard"></lightning-input-field>
                    </lightning-layout-item>

                </lightning-layout><br /><br /><br />

            </form>
        </lightning-record-edit-form>
        <div class="slds-docked-form-footer">
            <button class="slds-button slds-button_icon slds-button_icon slds-button_icon-error" title="Resolve error"
                if:true={showValidationPopup}>
                <lightning-icon icon-name="utility:error" alternative-text="Error" size="xx-small" title="large size"
                    variant="brand" aria-hidden="true"></lightning-icon>
                <span class="slds-assistive-text">Mandatory Details</span>
            </button>


            <lightning-button variant="brand" title="Previous" onclick={handleFourthPagePrevious} type="button"
                label="Previous"></lightning-button> &nbsp; &nbsp;

            <lightning-button variant="brand" title="Next" onclick={handleFourthPageNext} type="button"
                label="Next"></lightning-button>


            <section if:true={showValidationPopup} aria-describedby="dialog-body-id-5"
                aria-labelledby="dialog-heading-id-3" class="slds-popover slds-popover_error slds-nubbin_bottom-left"
                role="dialog"
                style="position:absolute;bottom:56px;left:50%;margin-left:62px;transform:translateX(-50%)">
                <button
                    class="slds-button slds-button_icon slds-button_icon-small slds-float_right slds-popover__close slds-button_icon-inverse"
                    title="Close dialog">
                    <lightning-icon icon-name="utility:close" alternative-text="CLose" size="xx-small"
                        title="large size" variant="inverse" class="slds-icon slds-icon_x-small" aria-hidden="true"
                        onclick={handleclosepopup}></lightning-icon>

                    <span class="slds-assistive-text">Close dialog</span>
                </button>
                <header class="slds-popover__header">
                    <div class="slds-media slds-media_center slds-has-flexi-truncate ">
                        <div class="slds-media__figure">
                            <span class="slds-icon_container slds-icon-utility-error">
                                <lightning-icon icon-name="utility:error" alternative-text="Error" size="xx-small"
                                    title="large size" variant="inverse" class="slds-icon slds-icon_x-small"
                                    aria-hidden="true"></lightning-icon>
                            </span>
                        </div>
                        <div class="slds-media__body" if:true={showValidationPopup}>
                            <h2 class="slds-truncate slds-text-heading_medium" id="dialog-heading-id-7"
                                title="Resolve error">Mandatory Fields</h2>
                        </div>
                    </div>
                </header>
                <div class="slds-popover__body" id="dialog-body-id-9">
                    <p if:true={showValidationPopup}> {showValidation}
                        <!-- <a href="#" title="Learn More">Learn More</a> -->
                    </p>
                </div>
            </section>
        </div>
    </template>
    <!-- Employment Details -->


    <!-- Requirement Details -->
    <template if:true={showFifthPage}>
        <div class="mains">
            <div class="main">
                <h1 class="head">Requirement Details</h1>
            </div>
        </div>
        <div class="fixed-image">
            <lightning-formatted-rich-text value={showProjectImage}>
            </lightning-formatted-rich-text>
        </div>

        <lightning-record-edit-form density="compact" object-api-name="Site_Visit__c">
            <form class="slds-p-around_medium">
                <lightning-layout multiple-rows>
                    <lightning-layout-item size="6" class="slds-p-around_xx-small">
                        <lightning-input-field field-name="Configuration_Required__c"
                            value={svWrapper.sv.Configuration_Required__c} required onchange={handleChange}
                            variant="standard"></lightning-input-field>
                    </lightning-layout-item>
                    <lightning-layout-item size="6" class="slds-p-around_xx-small">
                        <lightning-input-field field-name="Budget_Range__c" value={svWrapper.sv.Budget_Range__c}
                            required onchange={handleChange} variant="standard"></lightning-input-field>
                    </lightning-layout-item>
                </lightning-layout>

                <lightning-layout multiple-rows>
                    <lightning-layout-item size="6" class="slds-p-around_xx-small">
                        <lightning-input-field field-name="Area_Sq_Ft__c" value={svWrapper.sv.Area_Sq_Ft__c} required
                            onchange={handleChange} variant="standard"></lightning-input-field>
                    </lightning-layout-item>
                    <lightning-layout-item size="6" class="slds-p-around_xx-small">
                        <lightning-input-field field-name="Buying_Purpose__c" value={svWrapper.sv.Buying_Purpose__c}
                            required onchange={handleChange} variant="standard"></lightning-input-field>
                    </lightning-layout-item>
                </lightning-layout>

                <lightning-layout multiple-rows>
                    <lightning-layout-item size="6" class="slds-p-around_xx-small">
                        <lightning-input-field field-name="Possession_Timeframe_Required__c"
                            value={svWrapper.sv.Possession_Timeframe_Required__c} required onchange={handleChange}
                            variant="standard"></lightning-input-field>
                    </lightning-layout-item>
                </lightning-layout><br /><br /><br />

            </form>
        </lightning-record-edit-form>

        <div class="slds-docked-form-footer">
            <button class="slds-button slds-button_icon slds-button_icon slds-button_icon-error" title="Resolve error"
                if:true={showValidationPopup}>
                <lightning-icon icon-name="utility:error" alternative-text="Error" size="xx-small" title="large size"
                    variant="brand" aria-hidden="true"></lightning-icon>
                <span class="slds-assistive-text">Mandatory Details</span>
            </button>


            <lightning-button variant="brand" title="Previous" onclick={handlefifthpagePrevious} type="button"
                label="Previous"></lightning-button> &nbsp;&nbsp;

            <lightning-button variant="brand" title="Submit" onclick={handlesubmit} type="button"
                label="Submit"></lightning-button>

            <section if:true={showValidationPopup} aria-describedby="dialog-body-id-5"
                aria-labelledby="dialog-heading-id-3" class="slds-popover slds-popover_error slds-nubbin_bottom-left"
                role="dialog"
                style="position:absolute;bottom:56px;left:50%;margin-left:62px;transform:translateX(-50%)">
                <button
                    class="slds-button slds-button_icon slds-button_icon-small slds-float_right slds-popover__close slds-button_icon-inverse"
                    title="Close dialog">
                    <lightning-icon icon-name="utility:close" alternative-text="CLose" size="xx-small"
                        title="large size" variant="inverse" class="slds-icon slds-icon_x-small" aria-hidden="true"
                        onclick={handleclosepopup}></lightning-icon>

                    <span class="slds-assistive-text">Close dialog</span>
                </button>
                <header class="slds-popover__header">
                    <div class="slds-media slds-media_center slds-has-flexi-truncate ">
                        <div class="slds-media__figure">
                            <span class="slds-icon_container slds-icon-utility-error">
                                <lightning-icon icon-name="utility:error" alternative-text="Error" size="xx-small"
                                    title="large size" variant="inverse" class="slds-icon slds-icon_x-small"
                                    aria-hidden="true"></lightning-icon>
                            </span>
                        </div>
                        <div class="slds-media__body" if:true={showValidationPopup}>
                            <h2 class="slds-truncate slds-text-heading_medium" id="dialog-heading-id-8"
                                title="Resolve error">Mandatory Fields</h2>
                        </div>
                    </div>
                </header>
                <div class="slds-popover__body" id="dialog-body-id-10">
                    <p if:true={showValidationPopup}> {showValidation}
                        <!-- <a href="#" title="Learn More">Learn More</a> -->
                    </p>
                </div>
            </section>
        </div>
    </template>
    <!-- Requirement Details -->

    <!-- show final screen  -->
    <template if:true={showFinalScreen}>
        <div class="slds-grid slds-wrap slds-grid_vertical-align-center slds-grid_align-center"
            style="min-height: 100vh;">
            <div class="slds-p-around_medium" style="border: 1px solid #d8dde6; max-width: 400px;">
                <div class="">
                    <template if:true={getFinalResult} for:each={getFinalResult} for:item="con" for:index="index">
                        <div class="slds-text-align_center" key={con.key}>
                            <h1 class="slds-text-heading_medium">{con.value}</h1>
                            <p style="text-align: center;color:#0e3aed;padding:10px;"> </p>
                            <template if:false={isQrcustomer}>
                                <lightning-button variant="brand" title="Please Click here to view Record"
                                    value={con.key} onclick={ClickHere} type="button"
                                    label="Please Click here to view Record"></lightning-button> &nbsp;&nbsp;
                            </template>
                        </div>
                    </template>
                </div>
            </div>
        </div>
        </div>
    </template>

    <!-- show final screen  -->



</template>