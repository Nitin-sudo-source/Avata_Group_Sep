<template>
    <div style="border: 2px solid black;margin:15px;">
        <div if:true={isSpinner} class="spinner-container">
            <div class="loader"></div>
            <div class="wait-text">Please wait...</div>
        </div>
        <lightning-card>
            <lightning-record-view-form record-id={recordId} object-api-name="Booking__c">
                <div style="Padding:10px;">
                    <table class="Table1Css">
                        <tr>
                            <th colspan="4"
                                style="text-align:center; font-size:18px;border: 1px solid black;padding:8px; background:#4fb7b2; color: black;">
                                Booking Details
                            </th>
                        </tr>
                        <tr>
                            <th>Project Name</th>
                            <td>
                                <lightning-output-field variant="label-hidden" field-name="Project__c">
                                </lightning-output-field>
                            </td>
                            <th>Tower Name</th>
                            <td>
                                <lightning-output-field variant="label-hidden" field-name="Tower__c">
                                </lightning-output-field>
                            </td>
                        </tr>
                        <tr>
                            <th>Opportunity Name</th>
                            <td>
                                <lightning-output-field variant="label-hidden" field-name="Opportunity__c">
                                </lightning-output-field>
                            </td>
                            <th>Unit Name</th>
                            <td>
                                <lightning-output-field variant="label-hidden" field-name="Unit__c">
                                </lightning-output-field>
                            </td>
                        </tr>
                        <tr>
                            <th>Booking Date</th>
                            <td>
                                <lightning-output-field variant="label-hidden" field-name="Booking_Date__c">
                                </lightning-output-field>
                            </td>
                            <th>Total Amount Received</th>
                            <td colspan="3">
                                <lightning-output-field variant="label-hidden" field-name="Total_Amount_Received__c">
                                </lightning-output-field>
                            </td>
                        </tr>
                    </table>
                </div>
            </lightning-record-view-form>
            <br />
            <div style="Padding:10px;">
                <lightning-record-edit-form record-id={recordId} object-api-name="Booking__c">
                    <table class="Table1Css">
                        <tr>
                            <th colspan="4"
                            style="text-align:center; font-size:18px;border: 1px solid black;padding:8px; background:#4fb7b2; color: black;">
                            Cancellation Details
                            </th>
                        </tr>
                        <tr>
                            <th>Cancellation Type </th>
                            <td>
                                <lightning-input-field variant="label-hidden" field-name="Cancellation_Type__c"
                                    required
                                    onchange={handleCancelChange}> 
                                </lightning-input-field>
                                <template if:true={showCancelError}>
                                    <div style="color: red; font-size: 12px;">Please select cancellation type</div>
                                </template>
                            </td>
                            <th>Please Enter Refund Amount </th>
                            <td>
                                <lightning-input type="number" 
                                    data-formfield="Refund_Amount__c" 
                                    variant="label-hidden" 
                                    placeholder="0.00" 
                                    formatter="currency" 
                                    step="0.01"
                                    required
                                    value={amount}
                                    onchange={onchnageamount}>
                                </lightning-input>
                                <template if:true={showAmountError}>
                                    <div style="color: red; font-size: 12px;">Please enter valid amount</div>
                                </template>
                            </td>
                        </tr>
                        <tr>
                            <th>Please Upload Cancellation Document </th>
                            <td>
                                <lightning-file-upload variant="label-hidden" name="fileUploader"
                                    accept={acceptedFormats} record-id={recordId}
                                    onuploadfinished={handleUploadFinished}>
                               </lightning-file-upload>
                                <template if:true={showfilename}>
                                    <p>{showfilename}</p>
                                </template>
                            </td>
                            <th>Please Enter Cancellation Remarks </th>
                            <td>
                                <lightning-textarea style="margin-right: 20px;" 
                                    variant="label-hidden"
                                    data-formfield="Cancellation_Remark__c" 
                                    placeholder="Please Enter Cancellation Remark"
                                    required
                                    value={reason} 
                                    onchange={handleReasonChange}>
                                </lightning-textarea>
                                <template if:true={showReasonError}>
                                    <div style="color: red; font-size: 12px;">Remarks are required</div>
                                </template>
                            </td>
                        </tr>
                    </table>
                </lightning-record-edit-form>
            </div>
            <div class="center">
                <lightning-button variant="brand" 
                    label="Submit For Cancellation" 
                    onclick={createBookData}
                    disabled={hasValidationError}
                    style="font-family: Arial, Helvetica, sans-serif;font-weight: bold;padding:10px;">
                </lightning-button>
            </div>
        </lightning-card>
    </div>
</template>